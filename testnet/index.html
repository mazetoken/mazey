<!DOCTYPE html>
<html lang="en">
<head>
  	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
  	<title>Mazey BCH wallet (testnet)</title>
	<meta name="description" content="Mazey Bitcoin Cash CashTokens wallet powered by Microfi Free Flow">
  	<meta name="web" content="https://mazetoken.github.io/mazey/testnet/">
	<style>
		body {
			text-align: center;
			overflow-wrap: anywhere;
			max-width: 800px;
			margin: auto;
			font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
			background-color: black;
			font-size: large;
			color: whitesmoke;
		}
		p {
			font-size: 14px;
		}
		a:link {
			color: #0AC18E;
			background-color: transparent;
			text-decoration: none;
		}
		a:visited {
			color: #0AC18E;
			background-color: transparent;
			text-decoration: none;
		}
		.collapsible {
			background-color: #0AC18E;
			border-radius: 12px;
			font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
			color: white;
			cursor: pointer;
			padding: 18px;
			width: 50%;
			border: none;
			text-align: center;
			outline: none;
			font-size: 14px;
		}
		.active, .collapsible:hover {
			background-color: #0AC18E;
		}
		.content {
			padding: 0 16px;
			display: none;
			overflow: hidden;
			background-color: black;
		}
		@media screen and (max-width: 512px) {
		}
	</style>
	<script defer src="https://cdn.jsdelivr.net/npm/mainnet-js@1.1.31/dist/mainnet-1.1.31.js" integrity="sha256-rmOpIf/WGsAIIHtE8D7zTWOhHKo/ZMW730ROMPLWZCI=" crossorigin="anonymous"></script>
</head>
<body>
	<div>
		<h1>MAZEy</h1>
		<h3>Bitcoin Cash <a href="https://cashtokens.org">CashTokens</a> wallet</h3>
		<p>(on testnet)</p>
		<p>Powered by <a href="https://microfi.eu">Microfi Free Flow</a></p>
		<p>MAZEy can be used locally, on a pendrive, SD card, floppy disk, etc.<br>
			Clear local storage if the wallet is being used on someone else's device or if you want to create a new wallet.
		</p>
		<p>The wallet also supports <a href="https://crc20.cash">CRC20</a> CashTokens. You can import the BCH wallet private key derived from your MetaMask account.</p>
		<p>MAZEy wallet is under development. Use it at your own risk and with small amount of BCH.</p>
		<h3>Try MAZEy <a href="https://mazetoken.github.io/mazey/testnet/paperwallet">CashTokens paper wallet</a> (testnet).</h3>
		<hr>
		<div>
			<button type="button" class="collapsible">Create or import a wallet</button>
			<div class="content">
				<p>Create a new wallet:</p>
				<p><button type="button" id="create">Create</button></p>
				<p>Import a wallet from seed phrase or private key:</p>
				<p><input id="importSeedPhrase" type="text" size="50" placeholder="seed phrase"></p>
				<p>or</p>
				<p><input id="importPrivateKey" type="text" size="50" placeholder="private key (WIF)"></p>
				<p><button type="button" id="import">Import</button></p>
				<p id="alert1"></p>
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Open wallet</button>
			<div class="content">
				<p><button type="button" id="open">Open</button></p>
				<p id="bchaddress"></p>
				<p id="walletPubKey"></p>
				<p id="cashtokensaddress"></p>
				<p id="bchbalance"></p>
				<p id="derivation"></p>
				<p id="mnemonic"></p>
				<p id="privatekey"></p>
				<p id="tokens"></p>
				<p id="nfts"></p>
				<p>To update your balances, refresh the page and open the wallet again.<br>
					View token details below.
				</p>
				<p><button type="button" id="refresh">Refresh</button></p>
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Clear local storage</button>
			<div class="content">
				<p><button type="button" id="clear">Clear</button></p>
				<p>The wallet will be deleted - the seed phrase / private key will be removed from the local storage of the browser.</p>
				<p id="alert2"></p>
			</div>
		</div>
		<hr>
		<!-- <div>
			<button type="button" class="collapsible">View token details</button>
			<div class="content">
				<p>mainnet only</p>
				<p><input id="viewTokenId" type="text" size="50" placeholder="tokenId"></p>
				<p><button type="button" id="viewTokens1">View - AuthChain</button><br>* wait a few seconds</p>
				<p><button type="button" id="viewTokens2">View - Paytaca Api</button></p>
				<p>Choose metadata registry from the list.<br>
					If custom BCMR is selected, paste url in the input field.</p>
				<select id="bcmrList">
					<option value="https://mazetoken.github.io/.well-known/crc20tobcmr.json">CRC20-to-BCMR</option>
					<option value="https://mazetoken.github.io/.well-known/bitcoin-cash-metadata-registry.json">Maze Token MTU BCMR</option>
					<option value="https://mazetoken.github.io/darklabs/bcmr/darklabsbcmr.json">Dark Labs CRC20 BCMR</option>
					<option value="https://otr.cash/.well-known/bitcoin-cash-metadata-registry.json">Open Token Registry BCMR</option>
					<option value="">custom BCMR</option>
				</select>
				<p><input id="bcmrCustom" type="text" size="50" placeholder="custom BCMR"></p>
				<p><button type="button" id="viewTokens3">View - BCMR list</button></p>
				<p id="tokencategory"></p>
				<p id="tokenname"></p>
				<p id="tokensymbol"></p>
				<p id="tokendecimals"></p>
				<p id="tokendescription"></p>
				<img src id="tokenicon" width="200"></p>
				<p id="explorer"></p>
				<p id="tokenapi"></p>
			</div>
		</div>
		<hr> -->
		<div>
			<button type="button" class="collapsible">Send BCH</button>
			<div class="content">
				<p><input id="sendAddr" type="text" size="50" placeholder="bchtest:..."></p>
				<p><input id="sendAmount" type="text" size="50" placeholder="amount in satoshis"></p>
				<p><button id="sendBCH">Send BCH</button></p>
				<p><button id="sendBCHmax">Send the entire BCH balance</button></p>
				<p id="bchsent"></p>
				<!-- <img src id="imagetxid1" width="150"></p> -->
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Send fungible CashTokens</button>
			<div class="content">
				<p><input id="sendAddrToken" type="text" size="50" placeholder="bchtest:z..."></p>
				<p><input id="sendAmountToken" type="text" size="50" placeholder="amount with decimals e.g. 10000 is 100 with 2 decimals"></p>
				<p><input id="sendTokenId" type="text" size="50" placeholder="tokenId"></p>
				<p><button type="button" id="sendTokens">Send tokens</button></p>
				<p id="ftsent"></p>
				<!-- <img src id="imagetxid2" width="150"></p> -->
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Send NFT CashTokens</button>
			<div class="content">
				<p><input id="sendAddrToken1" type="text" size="50" placeholder="bchtest:z..."></p>
				<p><input id="sendNftTokenId" type="text" size="50" placeholder="tokenId"></p>
				<p><input id="nftCommitment" type="text" size="50" placeholder="NFT commitment"></p>
				<p><button type="button" id="sendNfts">Send immutable NFT</button></p>
				<p id="nftsent"></p>
				<!-- <img src id="imagetxid3" width="150"></p> -->
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Burn tokens</button>
			<div class="content">
				<p><input id="burnTokenId" type="text" size="50" placeholder="tokenId (category)"></p>
				<p><input id="burnAmount" type="text" size="50" placeholder="amount"></p>
				<p><button type="button" id="burnFt">Burn fungible tokens</button></p>
				<p id="burnFtTx"></p>
				<p><input id="burnNftId" type="text" size="50" placeholder="NFT tokenId (category)"></p>
				<!-- <p><input id="burnNftAmount" type="text" size="50" placeholder="amount"></p> -->
				<p><input id="burnCommitment" type="text" size="50" placeholder="NFT commitment (hex)"></p>
				<!-- <select id="capabilityList">
					<option value="NFTCapability.none">Immutable</option>
					<option value="NFTCapability.minting">Minting</option>
					<option value="NFTCapability.mutable">Mutable</option>
				</select>
				<p>* choose NFT capability from the list</p> -->
				<p><button type="button" id="burnNft">Burn immutable NFT</button></p>
				<p id="burnNftTx"></p>
				<!-- <img src id="imagetxid3" width="150"></p> -->
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Sweep paper wallet</button>
			<div class="content">
				<p>Before sweeping, check the balance of the paper wallet.<br> 
					You can create a Mazey wallet or import an existing wallet into Mazey and paste the BCH address into the recipient field, or simply use your favorite BCH wallet address (which supports CashTokens) in the recipient field.
				</p>
				<p><input id="sweepPk" type="text" size="50" placeholder="Paste a paper wallet private key (WIF) here"></p>
				<p><button id="balancePw">Check paper wallet balance</button></p>
				<p id="bchbalancePw"></p>
				<p id="tokenbalancePw"></p>
				<p><input id="recipientAddress" type="text" size="50" placeholder="recipient address bchtest:..."></p>
				<p><button id="sweepPw">Sweep tokens and BCH</button> * if paper the wallet has tokens and BCH</p>
				<p><button id="sweepPwBch">Sweep BCH</button> * if the paper wallet has only BCH</p>
				<p id="swept"></p>
				<!-- <img src id="imagetxid4" width="150"></p> -->
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Watch wallet</button>
			<div class="content">
				<p><input id="wAddress" type="text" size="50" placeholder="bchtest:..."></p>
				<p><button type="button" id="spy">Watch wallet balances</button></p>
				<p id="wbchbalance"></p>
				<p id="wtokens"></p>
				<p id="wnfts"></p>
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Payment request url (BCH only)</button>
			<div class="content">
				<p><input id="address" type="text" size="50" placeholder="address e.g. bchtest:qzud8n6jjjukefrswrqlvwwk8l6wv7435yg56xw20s"></p>
				<p><input id="amount" type="text" size="50" placeholder="amount e.g. 0.0001"></p>
				<p><input id="label" type="text" size="50" placeholder="some text"></p>
				<p><button type="button" id="createPaymentRequest">Create payment url</button></p>
				<p id="payurl"></p>
				
				<p><input id="upayurl" type="text" size="50" placeholder="payment request url"></p>
				<p><button type="button" id="usePaymentRequest">Use payment url</button> * with an external wallet</p>
				<p id="usepayurl"></p>
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Sign or verify a message</button>
			<div class="content">
				<p><input id="smessage" type="text" size="50" placeholder="message"></p>
				<p><button type="button" id="signM">Sign a message</button> * with MAZEy wallet</p>
				<p id="signMessage"></p>
				
				<p><input id="vaddress" type="text" size="50" placeholder="signing address"></p>
				<p><input id="signH" type="text" size="50" placeholder="signature"></p>
				<p><button type="button" id="verifyM">Verify a message</button></p>
				<p id="verifyMessage"></p>
			</div>
		</div>
		<hr>
		<div>
			<button type="button" class="collapsible">Send a message in op_return</button>
			<div class="content">
				<p><input id="opmessage" type="text" size="50" placeholder="message"></p>
				<p><button type="button" id="sendOp">Send</button></p>
				<p id="opsent"></p>
				<!-- <img src id="imagetxid5" width="150"></p> -->
			</div>
		</div>
		<hr>
		<br>
		<footer>
			<p><a href="https://github.com/mazetoken/mazey/">Github</a> | <a href="https://t.me/mazetokens/">Telegram</a></p>
			<p>Check:<br>
				<a href="https://microfi.eu">Microfi Free Flow</a> CashTokens<br>
				<a href="https://mazetoken.github.io/darklabs/">Dark Labs</a> CRC20 CashTokens<br>
				<a href="https://tapswap.cash/trade/4b53fb421e760fa3d6d1250b921a7833a6dad04e3566314164059aa0afd987d6">The Legendary Zombie Government</a> CashTokens NFTs
			</p>
			<p>Credits: <a href="https://mainnet.cash">mainnet.cash</a> | <a href="https://cashonize.com">Cashonize</a> | <a href="https://bcmr.paytaca.com/api/">Paytaca api</a>
				| <a href="https://gitlab.com/0353F40E/crc20-to-bcmr/-/blob/master/bcmr/bitcoin-cash-metadata-registry.json">crc20-to-bcmr</a>
				<!-- | <a href="https://www.figma.com/community/file/966199982810283152/Croodles---Doodle-your-face">Croodles</a> -->
			</p>
			<p>MAZEy on <a href="https://mazetoken.github.io/mazey/">mainnet</a></p>
			<p>Maze Tokens Underworld, 2023</p>
		</footer>
		<br>
	</div>

	<script>
		var coll = document.getElementsByClassName("collapsible");
		var i;
		for (i = 0; i < coll.length; i++) {
		  coll[i].addEventListener("click", function() {
			this.classList.toggle("active");
			var content = this.nextElementSibling;
			if (content.style.display === "block") {
			  content.style.display = "none";
			} else {
			  content.style.display = "block";
			}
		  });
		}
	</script>

	<script>
	document.addEventListener("DOMContentLoaded", async (event) => {
		globalThis.exports = globalThis.exports || {};
		Object.assign(globalThis, await __mainnetPromise);
		DefaultProvider.servers.testnet = ["wss://chipnet.imaginary.cash:50004"]
		//DefaultProvider.servers.testnet = ["wss://chipnet.c3-soft.com:64004"]
		//DefaultProvider.servers.testnet = ["wss://chipnet.bch.ninja:50004"]
		Config.DefaultParentDerivationPath = "m/44'/145'/0'/0/0";
		//Config.EnforceCashTokenReceiptAddresses = true;

		document.getElementById("create").onclick = async () => {
			const wallet = await TestNetWallet.named("tmazey");
			localStorage.setItem("tseed", wallet.mnemonic);
			localStorage.setItem("twif", wallet.privateKeyWif);
			alert("Done. You can open the wallet. Save the seed phrase and private key.");
			document.getElementById("alert1").textContent = "Done. You can open the wallet. Save the seed phrase and private key.";
		};

		document.getElementById("import").onclick = async () => {
			const seedphrase = document.querySelector("#importSeedPhrase").value;
			localStorage.setItem("tseed", seedphrase);
			const privatekey = document.querySelector("#importPrivateKey").value;
			localStorage.setItem("twif", privatekey);
			alert("Done. The wallet is imported. You can open the wallet.");
			document.getElementById("alert1").textContent = "Done. The wallet is imported. You can open the wallet.";
		}

		document.getElementById("open").onclick = async () => {
			var wallet = await TestNetWallet.named("tmazey");
			const sd = localStorage.getItem("tseed");
			const derivationPath = "m/44'/145'/0'/0/0";
			var walletId1 = `seed:mainnet:${sd}:${derivationPath}`;
			const pk = localStorage.getItem("twif");
			var walletId2 = `wif:mainnet:${pk}`;
			if (wallet = sd) {
				var wallet = await TestNetWallet.replaceNamed("tmazey", walletId1);
			} else if (wallet = pk) {
				var wallet = await TestNetWallet.replaceNamed("tmazey", walletId2);
			}
			const bchAddress = await wallet.getDepositAddress();
			const walletPubKey = wallet.getPublicKey(true);
			const tokenAddress = await wallet.getTokenDepositAddress();
			let bchBalance = await wallet.getBalance();
			let tokensAddressBalance = await wallet.getAllTokenBalances();
			let nftsAddressBalance = await wallet.getAllNftTokenBalances();
			
			document.getElementById("bchaddress").textContent = "BCH address: " + bchAddress;
			document.getElementById("walletPubKey").textContent = "PubKey (hex): " + walletPubKey;
			document.getElementById("cashtokensaddress").textContent = "CashTokens address: " + tokenAddress;
			document.getElementById("bchbalance").textContent = "BCH balance: " + JSON.stringify(bchBalance);
			document.getElementById("derivation").textContent = "Derivation path: " + wallet.derivationPath;
			document.getElementById("mnemonic").textContent = "Seed phrase: " + wallet.mnemonic;
			document.getElementById("privatekey").textContent ="Private key: " + wallet.privateKeyWif;
			document.getElementById("tokens").textContent = "tokenId(category): amount: " + JSON.stringify(tokensAddressBalance, null, "\t");
			document.getElementById("nfts").textContent = "NFT Id(category): amount: " + JSON.stringify(nftsAddressBalance, null, "\t");
		};

		document.getElementById("refresh").onclick = async () => {
			location.reload();
		}

		document.getElementById("clear").onclick = async () => {
			indexedDB.deleteDatabase("bchtest");
			//localStorage.clear();
			localStorage.removeItem("tseed");
			localStorage.removeItem("twif");
			alert("Seed phrase / private key were removed. You have to import a wallet again.");
			document.getElementById("alert2").textContent = "Seed phrase / private key were removed. You have to import a wallet again.";
			location.reload();
		}

		document.getElementById("viewTokens1").onclick = async () => {
			const viewTokenId1 = document.querySelector("#viewTokenId").value;
			const authChain = await BCMR.buildAuthChain({
				transactionHash: viewTokenId1,
				followToHead: true
			})
			if (authChain.at(-1)) {
			try {
				await BCMR.addMetadataRegistryFromUri(authChain.at(-1).httpsUrl);
			} catch (error) { alert(error) }
			}
			const tokenInfo = BCMR.getTokenInfo(viewTokenId);
			document.getElementById("tokencategory").textContent = "Category/tokenId: " + tokenInfo.token.category;
			document.getElementById("tokenname").textContent = "Name: " + tokenInfo.name;
			document.getElementById("tokensymbol").textContent = "Symbol: " + tokenInfo.token.symbol;
			document.getElementById("tokendecimals").textContent = "Decimals: " + tokenInfo.token.decimals;
			document.getElementById("tokendescription").textContent = "Description: " + tokenInfo.description;

			const viewIcon = tokenInfo.uris.icon;
			const HttpsPrefix = "https://";
			const IpfsPrefix = "ipfs://";
			if (viewIcon.startsWith(HttpsPrefix)) {
				document.getElementById("tokenicon").src = viewIcon;
			} else if (viewIcon.startsWith(IpfsPrefix)) {
				document.getElementById("tokenicon").src = "https://" + viewIcon.substr(7, viewIcon.length) + ".ipfs.dweb.link/";
			}

			//document.getElementById("tokenicon").src = tokenInfo.uris.icon;
			document.getElementById("explorer").textContent = "https://explorer.salemkode.com/token/" + viewTokenId1;
		};

		document.getElementById("viewTokens2").onclick = async () => {
			const viewTokenId2 = document.querySelector("#viewTokenId").value;
			const apiUrl = "https://bcmr.paytaca.com/api/tokens/" + viewTokenId2;
			const explorer = "https://explorer.salemkode.com/token/" + viewTokenId2;
			fetch(apiUrl)
				.then(response => response.json())
				.then(data => document.getElementById("tokenapi").textContent = "Name: " + data.name + " " + "| Symbol: " + data.token.symbol + " " + "| Decimals: " + data.token.decimals + " " + "| Description: " + data.description + " " + " " + "| Web: " + data.uris.web + " " + "| Icon: " + data.uris.icon + " " + "| Explorer: " + explorer);
		};

		document.getElementById("viewTokens3").onclick = async () => {
			const viewTokenId3 = document.querySelector("#viewTokenId").value;
			const bcmrList = document.querySelector("#bcmrList").value;
			if (bcmrUrl = bcmrList) {
			try {
				await BCMR.addMetadataRegistryFromUri(bcmrList);
			} catch (error) { alert(error) }
			}
			const bcmrCustom = document.querySelector("#bcmrCustom").value;
			if (bcmrUrl = bcmrCustom) {
			try {
				await BCMR.addMetadataRegistryFromUri(bcmrCustom);
			} catch (error) { alert(error) }
			}
			const tokenInfo = BCMR.getTokenInfo(viewTokenId3);
			document.getElementById("tokencategory").textContent = "Category/tokenId: " + tokenInfo.token.category;
			document.getElementById("tokenname").textContent = "Name: " + tokenInfo.name;
			document.getElementById("tokensymbol").textContent = "Symbol: " + tokenInfo.token.symbol;
			document.getElementById("tokendecimals").textContent = "Decimals: " + tokenInfo.token.decimals;
			document.getElementById("tokendescription").textContent = "Description: " + tokenInfo.description;
			document.getElementById("tokenicon").src = tokenInfo.uris.icon;
			document.getElementById("explorer").textContent = "https://explorer.salemkode.com/token/" + viewTokenId3;
		};

		document.getElementById("sendBCH").onclick = async () => {
			try {
			const bchAddress = document.querySelector("#sendAddr").value;
			const bchAmount = document.querySelector("#sendAmount").value;
			const wallet = await TestNetWallet.named("tmazey");
			const { txId } = await wallet.send([{ cashaddr: bchAddress, value: bchAmount, unit: "sats" }]);
			document.getElementById("bchsent").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid1").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};

		document.getElementById("sendBCHmax").onclick = async () => {
			try {
			const bchAddress = document.querySelector("#sendAddr").value;
			const wallet = await TestNetWallet.named("tmazey");
			let bchBalanceMax = await wallet.getBalance();
			bchBalanceObj = Object.values({...bchBalanceMax});
			let bchBalMax = bchBalanceObj[1];
			const { txId } = await wallet.send([{ cashaddr: bchAddress, value: bchBalMax - 546, unit: "sats", }]);
			document.getElementById("bchsent").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid1").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};

		document.getElementById("sendTokens").onclick = async () => {
			try {
			const tokenAddress = document.querySelector("#sendAddrToken").value;
			const tokenAmount = document.querySelector("#sendAmountToken").value;
			const token = document.querySelector("#sendTokenId").value;
			const wallet = await TestNetWallet.named("tmazey");
			const { txId } = await wallet.send([new TokenSendRequest({ cashaddr: tokenAddress, amount: tokenAmount, tokenId: token })]);
			document.getElementById("ftsent").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid2").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};

		document.getElementById("sendNfts").onclick = async () => {
			try {
			const tokenAddress = document.querySelector("#sendAddrToken1").value;
			const token1 = document.querySelector("#sendNftTokenId").value;
			const nftCommitment = document.querySelector("#nftCommitment").value;
			const wallet = await TestNetWallet.named("tmazey");
			const { txId } = await wallet.send([new TokenSendRequest({ cashaddr: tokenAddress, tokenId: token1, commitment: nftCommitment, capability: NFTCapability.none })]);
			document.getElementById("nftsent").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid3").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};

		document.getElementById("burnFt").onclick = async () => {
			try {
			const wallet = await TestNetWallet.named("tmazey");
			const burnTokenId = document.querySelector("#burnTokenId").value;
			const burnAmount = document.querySelector("#burnAmount").value;
			const burnResponse = await wallet.tokenBurn(
				{
					tokenId: burnTokenId,
					amount: burnAmount
				},
				"burn",
				);
			const { txId } = burnResponse;
			document.getElementById("burnFtTx").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			} catch (error) { alert(error) }
		};

		document.getElementById("burnNft").onclick = async () => {
			try {
			const wallet = await TestNetWallet.named("tmazey");
			const burnNftTokenId = document.querySelector("#burnNftId").value;
			//const burnNftAmount = document.querySelector("#burnNftAmount").value;
			//const capabilityList = document.querySelector("#capabilityList").value;
			const burnCommitment = document.querySelector("#burnCommitment").value;
			const burnResponse = await wallet.tokenBurn(
				{
					tokenId: burnNftTokenId,
					//amount: burnNftAmount,
					capability: NFTCapability.none,
					//capability: capabilityList,
    				commitment: burnCommitment,
				},
				"burn",
				);
			const { txId } = burnResponse;
			document.getElementById("burnNftTx").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			} catch (error) { alert(error) }
		};

		document.getElementById("balancePw").onclick = async () => {
			try {
			const sweepPk = document.querySelector("#sweepPk").value;
			var tempWallet = await TestNetWallet.fromWIF(sweepPk);
			let bchBalancePw = await tempWallet.getBalance();
			let tokensAddressBalancePw = await tempWallet.getAllTokenBalances();
			document.getElementById("bchbalancePw").textContent = "BCH balance: " + JSON.stringify(bchBalancePw);
			document.getElementById("tokenbalancePw").textContent = "Token balance: " + JSON.stringify(tokensAddressBalancePw);
			} catch (error) { alert(error) }
		};

		document.getElementById("sweepPw").onclick = async () => {
			try {
			var wallet = await TestNetWallet.named("tmazey");
			const sweepPk = document.querySelector("#sweepPk").value;
			const recipientPw = document.querySelector("#recipientAddress").value;
			var tempWallet = await TestNetWallet.fromWIF(sweepPk);
			let bchBalancePw = await tempWallet.getBalance();
			bchBalanceObj = Object.values({...bchBalancePw});
			let bchBal = bchBalanceObj[1];
			let tokensAddressBalancePw = await tempWallet.getAllTokenBalances();
			tokenCategoriesObj = Object.keys({...tokensAddressBalancePw});
			let tokenCat = tokenCategoriesObj[0];
			tokenAmountsObj = Object.values({...tokensAddressBalancePw});
			let tokenAmo = tokenAmountsObj[0];
			const { txId } = await tempWallet.send([
				{
				cashaddr: recipientPw,
				value: bchBal - 800,
				unit: "sats",
				},
				new TokenSendRequest(
				{
				cashaddr: recipientPw,
				amount: tokenAmo,
				tokenId: tokenCat,
				}),
			]);
			document.getElementById("swept").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid4").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};

		document.getElementById("sweepPwBch").onclick = async () => {
			try {
			var wallet = await TestNetWallet.named("tmazey");
			const sweepPk = document.querySelector("#sweepPk").value;
			const recipientPw = document.querySelector("#recipientAddress").value;
			var tempWallet = await TestNetWallet.fromWIF(sweepPk);
			let bchBalancePw = await tempWallet.getBalance();
			bchBalanceObj = Object.values({...bchBalancePw});
			let bchBal = bchBalanceObj[1];
			const { txId } = await tempWallet.send([
				{
				cashaddr: recipientPw,
				value: bchBal - 546,
				unit: "sats",
				},
			]);
			document.getElementById("swept").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid4").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};
	});
	</script>

	<script>
		document.getElementById("spy").onclick = async () => {
			const wAddress = document.querySelector("#wAddress").value;
			const wallet = await TestNetWallet.watchOnly(wAddress);
			let wbchBalance = await wallet.getBalance();
			let wtokensAddressBalance = await wallet.getAllTokenBalances();
			let wnftsAddressBalance = await wallet.getAllNftTokenBalances();
			document.getElementById("wbchbalance").textContent = "BCH balance: " + JSON.stringify(wbchBalance);
			document.getElementById("wtokens").textContent = "tokenId(category): amount: " + JSON.stringify(wtokensAddressBalance, null, "\t");
			document.getElementById("wnfts").textContent = "NFT Id(category): amount: " + JSON.stringify(wnftsAddressBalance, null, "\t");
		};
	</script>

	<script>
		document.getElementById("createPaymentRequest").onclick = async () => {
			const pAddress = document.querySelector("#address").value;
			const pAmount = document.querySelector("#amount").value;
			const pLabel = document.querySelector("#label").value;
			const pUrl = pAddress + "?amount=" + pAmount + "&label=" + pLabel;">";
			document.getElementById("payurl").textContent = pUrl;
			//location.href = pUrl;
		};
		document.getElementById("usePaymentRequest").onclick = async () => {
			const uPayUrl = document.querySelector("#upayurl").value;
			//const upUrl = uPayUrl;
			document.getElementById("usepayurl").textContent = uPayUrl;
			location.href = uPayUrl;
		};
	</script>

	<script>
		document.getElementById("signM").onclick = async () => {
			const sMessage = document.querySelector("#smessage").value;
			const wallet = await TestNetWallet.named("tmazey");
			wallet.cashaddr;
			sign = (await wallet.sign(sMessage)).signature;
			document.getElementById("signMessage").textContent = sign;
		};
		document.getElementById("verifyM").onclick = async () => {
			const vAddress = document.querySelector("#vaddress").value;
			const signatureHash = document.querySelector("#signH").value;
			someWallet = await TestNetWallet.watchOnly(vAddress);
			verifyResult = await someWallet.verify(vAddress, signatureHash);
			document.getElementById("verifyMessage").textContent = verifyResult.valid;
		};
	</script>

	<script>
		document.getElementById("sendOp").onclick = async () => {
			try {
			const opMessage = document.querySelector("#opmessage").value;
			const wallet = await TestNetWallet.named("tmazey");
			//const cashtokensAddress = await wallet.getTokenDepositAddress();
			const { txId } = await wallet.send([ OpReturnData.from(opMessage) ]);
			//const { txId } = await wallet.send([
			//OpReturnData.from("ORM" + opMessage),
				//{ 
				//cashaddr: cashtokensAddress,
				//value: 546,
				//unit: "sats"
				//},
			//]);
			document.getElementById("opsent").textContent = "https://chipnet.imaginary.cash/tx/" + txId;
			//document.getElementById("imagetxid5").src = "https://api.dicebear.com/6.x/croodles/svg?seed=" + txId + "&backgroundColor=ffffff";
			} catch (error) { alert(error) }
		};
	</script>
</body>
</html>